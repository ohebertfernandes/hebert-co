<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPS T√°tico: Hebert & Co. | Do Zero ao Imp√©rio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <!-- Chosen Palette: Executive Gold & Slate -->
    <!-- Background: #F8FAFC (Slate-50) for clean paper feel -->
    <!-- Primary Text: #1E293B (Slate-800) -->
    <!-- Accent/Brand: #B45309 (Amber-700) for Gold/Luxury cues -->
    <!-- Success: #059669 (Emerald-600) for Money goals -->
    <!-- Operational: #475569 (Slate-600) for Tasks -->

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8FAFC; color: #1E293B; }
        h1, h2, h3, h4, .serif { font-family: 'Playfair Display', serif; }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            height: 300px;
            max-height: 400px;
        }

        /* Checkbox Styling Logic */
        .checkbox-wrapper input:checked + div {
            background-color: #F1F5F9; /* Slate-100 */
            border-color: #64748B; /* Slate-500 */
            text-decoration: line-through;
            color: #94A3B8; /* Slate-400 */
        }

        .checkbox-wrapper input:checked + div .check-box-square {
            background-color: #475569; /* Slate-600 */
            border-color: #475569;
        }

        .checkbox-wrapper input:checked + div .check-icon {
            opacity: 1;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

        .nav-item.active {
            background-color: #1E293B;
            color: #F8FAFC;
            border-left: 4px solid #B45309;
        }

        /* Animation for number updates */
        .number-bump {
            animation: bump 0.3s ease-out;
        }
        @keyframes bump {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); color: #059669; }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 h-16 flex-none z-20 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 h-full flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-8 h-8 bg-slate-900 text-white flex items-center justify-center font-serif font-bold text-xl rounded-sm">H</div>
                <div>
                    <h1 class="font-serif font-bold text-lg tracking-wide text-slate-900 leading-none">HEBERT & CO.</h1>
                    <p class="text-[10px] uppercase tracking-[0.2em] text-amber-700 font-semibold">GPS T√°tico 2025</p>
                </div>
            </div>
            <div class="hidden md:flex items-center gap-6 text-sm">
                <div class="flex flex-col items-end">
                    <span class="text-xs text-slate-500 uppercase">Meta Final (Nov)</span>
                    <span class="font-bold text-emerald-700">R$ 99.000,00</span>
                </div>
                <div class="h-8 w-px bg-gray-200"></div>
                <div class="flex flex-col items-end">
                    <span class="text-xs text-slate-500 uppercase">Caixa Acumulado (Alvo)</span>
                    <span id="global-cash-display" class="font-bold text-amber-700">R$ 0 / R$ 36.340</span>
                </div>
            </div>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        
        <!-- Sidebar Navigation (Months) -->
        <nav class="w-20 md:w-64 bg-white border-r border-gray-200 flex-none overflow-y-auto flex flex-col">
            <div class="p-4 border-b border-gray-100">
                <h3 class="hidden md:block text-xs font-bold text-slate-400 uppercase tracking-wider mb-2">Cronograma</h3>
                <p class="md:hidden text-center text-xs font-bold text-slate-400">M√äS</p>
            </div>
            <div id="month-nav" class="flex-1">
                <!-- Nav items generated by JS -->
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-1 overflow-y-auto p-4 md:p-8 bg-[#F8FAFC] relative">
            
            <div class="max-w-6xl mx-auto space-y-8">
                
                <!-- Section 1: Strategic Context (Intro Paragraph) -->
                <section class="bg-white p-6 rounded-lg shadow-sm border-l-4 border-amber-600">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                        <div>
                            <span id="current-phase-badge" class="inline-block px-3 py-1 bg-amber-100 text-amber-800 text-xs font-bold uppercase tracking-wider rounded-full mb-2">Fase 1</span>
                            <h2 id="month-title" class="serif text-3xl font-bold text-slate-900">Janeiro: Tra√ß√£o & Valida√ß√£o</h2>
                        </div>
                        <div class="text-right hidden md:block w-1/3">
                            <div class="flex justify-between items-end mb-1">
                                <p class="text-xs text-slate-500 uppercase">Progresso da Meta (Vendas)</p>
                                <p id="progress-text" class="text-xs font-bold text-emerald-600">0%</p>
                            </div>
                            <div class="w-full h-3 bg-gray-100 rounded-full overflow-hidden">
                                <div id="progress-bar" class="h-full bg-emerald-500 w-0 transition-all duration-500"></div>
                            </div>
                        </div>
                    </div>
                    <p id="month-desc" class="text-slate-600 leading-relaxed">
                        Este √© o momento zero. O foco n√£o √© lucro, √© movimento. Voc√™ validar√° a oferta e gerar√° o primeiro caixa sem gastar 1 centavo, usando networking e parceiros comissionados.
                    </p>
                </section>

                <!-- Sales Register (Caixa Registradora) -->
                <section class="bg-slate-900 text-white p-6 rounded-lg shadow-lg border border-slate-800">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-6">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 bg-emerald-600 rounded-full flex items-center justify-center text-2xl shadow-lg border border-emerald-400">
                                üí∞
                            </div>
                            <div>
                                <h3 class="font-serif font-bold text-lg">Registrar Venda Real</h3>
                                <p class="text-slate-400 text-xs">Adicione vendas manualmente para atualizar seu progresso.</p>
                            </div>
                        </div>
                        
                        <div class="flex items-center gap-3">
                            <div class="relative">
                                <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 text-sm">R$</span>
                                <input type="number" id="sale-input" value="160" class="w-24 bg-slate-800 border border-slate-700 rounded-md py-2 pl-8 pr-3 text-sm focus:outline-none focus:border-emerald-500 transition-colors text-white" placeholder="Valor">
                            </div>
                            <button onclick="addSale()" class="bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-2 rounded-md text-sm font-bold uppercase tracking-wider transition-all transform active:scale-95 shadow-lg border-b-2 border-emerald-800">
                                + Adicionar
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Section 2: Financial Dashboard for the Month -->
                <section class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <p class="text-xs text-slate-400 uppercase font-bold tracking-wider">Vendas (Real / Meta)</p>
                        <p id="stat-sales" class="text-2xl font-bold text-slate-900 mt-1">0 / 20 un.</p>
                        <p class="text-xs text-slate-500 mt-2">Foco: Volume</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <p class="text-xs text-slate-400 uppercase font-bold tracking-wider">Faturamento (Real / Meta)</p>
                        <p id="stat-revenue" class="text-2xl font-bold text-slate-900 mt-1">R$ 0 / R$ 3.200</p>
                        <p class="text-xs text-emerald-600 mt-2 font-medium">Margem Est: R$ 60/un</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100">
                        <p class="text-xs text-slate-400 uppercase font-bold tracking-wider">Reinvestimento (Ads)</p>
                        <p id="stat-ads" class="text-2xl font-bold text-amber-600 mt-1">R$ 0</p>
                        <p class="text-xs text-slate-500 mt-2">Calculado na Meta</p>
                    </div>
                    <div class="bg-white p-5 rounded-lg shadow-sm border border-gray-100 bg-slate-50">
                        <p class="text-xs text-slate-400 uppercase font-bold tracking-wider">Lucro Gerado (M√™s)</p>
                        <p id="stat-profit-real" class="text-2xl font-bold text-emerald-600 mt-1">R$ 0</p>
                        <p class="text-xs text-slate-400 mt-2 font-medium">Baseado em R$ 60/un</p>
                    </div>
                </section>

                <!-- Section 3: The Operational Checklist -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    
                    <!-- Checklist Column -->
                    <section class="lg:col-span-2 space-y-6">
                        <div class="flex items-center justify-between">
                            <h3 class="serif text-xl font-bold text-slate-800">Checklist de Execu√ß√£o</h3>
                            <button onclick="resetChecklist()" class="text-xs text-slate-400 hover:text-amber-600 underline">Resetar Tarefas</button>
                        </div>

                        <!-- NEW: Task Progress Bar -->
                        <div class="bg-white p-4 rounded-md border border-gray-200 shadow-sm">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-xs font-bold text-slate-500 uppercase tracking-wider">Progresso das Tarefas</span>
                                <span id="task-progress-text" class="text-xs font-bold text-slate-700">0/0 Conclu√≠das</span>
                            </div>
                            <div class="w-full h-2.5 bg-gray-100 rounded-full overflow-hidden">
                                <div id="task-progress-bar" class="h-full bg-slate-600 w-0 transition-all duration-500"></div>
                            </div>
                        </div>
                        
                        <div id="checklist-container" class="space-y-3">
                            <!-- Checklist items injected via JS -->
                        </div>

                        <div class="bg-amber-50 border border-amber-100 p-4 rounded-md mt-6">
                            <h4 class="text-sm font-bold text-amber-800 uppercase mb-1">üí° Dica do Estrategista</h4>
                            <p id="month-tip" class="text-sm text-amber-900 opacity-90">
                                Para vender sem estoque, use a escassez real. Diga "Consegui pegar apenas 5 unidades hoje" para o seu cliente. N√£o minta, mas use o limite log√≠stico a seu favor.
                            </p>
                        </div>
                    </section>

                    <!-- Monthly Analysis Column -->
                    <section class="space-y-8">
                        
                        <!-- Mini Chart: Cumulative Cash Goal -->
                        <div class="bg-slate-900 p-6 rounded-lg shadow-md text-white border-t-4 border-emerald-500">
                            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Caixa Acumulado (Simulado)</h3>
                            <div class="flex flex-col mb-4">
                                <span class="text-xs text-slate-400">Total Acumulado (Todas as Fases)</span>
                                <span id="stat-cash" class="text-3xl font-serif font-bold text-emerald-400">R$ 0</span>
                            </div>
                            <div class="w-full bg-slate-700 h-1.5 rounded-full overflow-hidden">
                                <div id="cash-bar" class="bg-emerald-500 h-full w-[0%]" style="transition: width 1s ease;"></div>
                            </div>
                            <p class="text-[10px] text-slate-400 mt-2 text-right">Meta Final (Out): R$ 36.340</p>
                        </div>

                        <!-- Mini Chart: Where the Money Goes -->
                        <div class="bg-white p-6 rounded-lg shadow-sm border border-gray-100">
                            <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4">Destino (Planejado)</h3>
                            <div class="chart-container" style="height: 200px;">
                                <canvas id="monthlyChart"></canvas>
                            </div>
                        </div>

                    </section>
                </div>

                <!-- Section 4: The Big Picture (Yearly Trajectory) -->
                <section class="bg-white p-6 md:p-8 rounded-lg shadow-sm border-t border-gray-100 mt-8">
                    <div class="mb-6">
                        <h3 class="serif text-2xl font-bold text-slate-800">O Efeito Bola de Neve ‚ùÑÔ∏è</h3>
                        <p class="text-slate-500 text-sm mt-1">
                            Acompanhe como o reinvestimento de 20% em tr√°fego (linha laranja) acelera o faturamento (barras) e o ac√∫mulo de caixa (linha verde) para o lan√ßamento.
                        </p>
                    </div>
                    <div class="chart-container" style="height: 350px;">
                        <canvas id="yearlyChart"></canvas>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <!-- JavaScript Application Logic -->
    <script>
        // --- DATA STORE ---
        // Derived from "Plano T√°tico Mestre: Hebert & Co."
        // Added 'actual' fields to track user progress
        const appData = [
            {
                id: 0,
                month: 'Janeiro',
                phase: 'Fase 1: Tra√ß√£o',
                focus: 'Venda Org√¢nica & Parceiros',
                desc: 'Valida√ß√£o da oferta e gera√ß√£o do primeiro caixa sem gastar 1 centavo. Foco total em "sola de sapato" digital e parcerias comissionadas.',
                tip: 'N√£o venda o perfume, venda a oportunidade exclusiva. "Consegui um lote de 5 unidades".',
                stats: { sales: 20, revenue: 3200, profit: 1200, ads: 0, salary: 0, accumulated: 1200 },
                actual: { sales: 0, revenue: 0, profit: 0 }, // User progress
                tasks: [
                    'Listar 50 contatos "quentes" no WhatsApp',
                    'Definir script de abordagem ("Lote Exclusivo")',
                    'Mapear 10 barbearias/consultores locais',
                    'Fechar 2 parcerias por comiss√£o (R$ 30/venda)',
                    'Postar Stories gerando escassez real',
                    'Separar R$ 1.200 de lucro no caixa (Intoc√°vel)'
                ]
            },
            {
                id: 1,
                month: 'Fevereiro',
                phase: 'Fase 2: Expans√£o Mix',
                focus: 'LTV & Decants',
                desc: 'Aumentar o ticket por cliente oferecendo variedade. Introdu√ß√£o de Decants (fra√ß√µes) para quem quer testar sem investir muito.',
                tip: 'Use a regra da indica√ß√£o: "Gostou? Indique um amigo e ganhe 10% off na pr√≥xima".',
                stats: { sales: 35, revenue: 5600, profit: 2100, ads: 0, salary: 0, accumulated: 3300 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Contatar os 20 clientes de Jan (P√≥s-venda)',
                    'Pedir 1 indica√ß√£o para cada cliente satisfeito',
                    'Montar kits de Decants (3x 5ml)',
                    'Interagir com 5 perfis executivos locais por dia',
                    'Validar lucro acumulado de R$ 3.300'
                ]
            },
            {
                id: 2,
                month: 'Mar√ßo',
                phase: 'Fase 3: Digitaliza√ß√£o',
                focus: 'Loja & Tr√°fego Inicial',
                desc: 'Profissionaliza√ß√£o da vitrine. In√≠cio t√≠mido do tr√°fego pago (R$ 600) para testar criativos e p√∫blicos.',
                tip: 'Loja bonita sem tr√°fego √© loja no deserto. O site deve ser simples e r√°pido.',
                stats: { sales: 50, revenue: 8000, profit: 3000, ads: 600, salary: 1000, accumulated: 4700 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Criar loja na Yampi/Cartpanda/Shopify',
                    'Gravar v√≠deo "User Generated Content" do produto',
                    'Configurar Business Manager do Meta Ads',
                    'Subir campanha (R$ 20/dia) focada na cidade',
                    'Sacar primeiro Pro-labore simb√≥lico (R$ 1.000)'
                ]
            },
            {
                id: 3,
                month: 'Abril',
                phase: 'Fase 4: Escala Inicial',
                focus: 'Prepara√ß√£o M√£es',
                desc: 'Aumentar a consist√™ncia. Prepara√ß√£o de estoque feminino para o Dia das M√£es.',
                tip: 'Comece a avisar sua Lista VIP sobre o Dia das M√£es 15 dias antes.',
                stats: { sales: 70, revenue: 11200, profit: 4200, ads: 840, salary: 1000, accumulated: 7060 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Estoque de perfumes femininos (Good Girl/La Vie)',
                    'Aumentar tr√°fego gradualmente (R$ 25/dia)',
                    'Campanha "Antecipe o Presente da M√£e"',
                    'Validar m√©tricas de an√∫ncio (CPA < R$ 25)'
                ]
            },
            {
                id: 4,
                month: 'Maio',
                phase: 'Fase 4: Escala (Pico 1)',
                focus: 'Dia das M√£es',
                desc: 'Primeiro grande teste de fogo. Foco total em opera√ß√£o e entrega r√°pida. O lucro aqui √© vital.',
                tip: 'Entregue r√°pido. No Dia das M√£es, o atraso √© imperdo√°vel.',
                stats: { sales: 110, revenue: 17600, profit: 6600, ads: 1320, salary: 1000, accumulated: 11340 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Opera√ß√£o de Guerra: Resposta r√°pida no Zap',
                    'Contratar motoboy extra para semana das M√£es',
                    'P√≥s-venda imediato para evitar devolu√ß√£o',
                    'Guardar TODO o excedente (Sacrif√≠cio R$ 1k)'
                ]
            },
            {
                id: 5,
                month: 'Junho',
                phase: 'Fase 4: Escala (Pico 2)',
                focus: 'Dia dos Namorados',
                desc: 'Campanhas de Kits de Casal. Volume alto de vendas. Manuten√ß√£o do sacrif√≠cio pessoal para engordar o caixa.',
                tip: 'Venda o "Combo Amor" (1 Masc + 1 Fem) para aumentar o ticket m√©dio.',
                stats: { sales: 120, revenue: 19200, profit: 7200, ads: 1440, salary: 1000, accumulated: 16100 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Criar oferta "Combo Casal" (Desconto progressivo)',
                    'Aumentar tr√°fego para R$ 40-50/dia',
                    'Repor estoque dos best-sellers p√≥s-data',
                    'Validar caixa acumulado: R$ 16.100'
                ]
            },
            {
                id: 6,
                month: 'Julho',
                phase: 'Fase 5: Pivot',
                focus: 'Aumento Ticket & Pro-labore',
                desc: 'Aumento do pro-labore para R$ 2.000 (respiro). Continuidade do tr√°fego pesado para manter a bola de neve girando.',
                tip: 'Analise os dados do semestre. Qual perfume vendeu mais? Foque nele.',
                stats: { sales: 140, revenue: 22400, profit: 8400, ads: 1680, salary: 2000, accumulated: 20820 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Aumentar Pro-labore para R$ 2.000',
                    'Pesquisa inicial de fornecedores (Frascos/Tampas)',
                    'Manter tr√°fego constante (R$ 55/dia)',
                    'Limpar estoque de itens de baixo giro'
                ]
            },
            {
                id: 7,
                month: 'Agosto',
                phase: 'Fase 5: Pivot (Pico 3)',
                focus: 'Dia dos Pais',
                desc: 'Data mais forte para masculino. Foco total em perfumes amadeirados e s√≥brios. √öltimo grande ac√∫mulo antes da produ√ß√£o.',
                tip: 'Argumento: "Um perfume √† altura do sucesso do seu pai".',
                stats: { sales: 150, revenue: 24000, profit: 9000, ads: 1800, salary: 2000, accumulated: 26020 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Campanha "Pai Executivo" (Foco em Couro/Madeira)',
                    'Investimento pesado em Ads (R$ 1.800)',
                    'Verificar saldo: Meta R$ 26.000 batida?',
                    'Iniciar contato com f√°brica para or√ßamento final'
                ]
            },
            {
                id: 8,
                month: 'Setembro',
                phase: 'Fase 5: Produ√ß√£o',
                focus: 'Encomenda "The Chairman"',
                desc: 'Momento da verdade. O dinheiro sai do caixa para a f√°brica. Encomenda do lote de 300 unidades.',
                tip: 'Pague √† vista para garantir prioridade na f√°brica. O Natal n√£o espera.',
                stats: { sales: 160, revenue: 25600, profit: 9600, ads: 1920, salary: 2000, accumulated: 31700 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Fechar contrato com Laborat√≥rio/F√°brica',
                    'Pagar produ√ß√£o do Lote 300un (R$ ~24k)',
                    'Finalizar design de r√≥tulos e caixas',
                    'Manter revenda rodando para pagar contas do m√™s'
                ]
            },
            {
                id: 9,
                month: 'Outubro',
                phase: 'Fase 6: Aquecimento',
                focus: 'Narrativa & Leads',
                desc: 'Mudan√ßa de chave. Menos foco em venda direta, mais foco em captar leads para o lan√ßamento. Suspense no ar.',
                tip: 'Mostre bastidores. "Algo novo est√° chegando". Crie curiosidade.',
                stats: { sales: 180, revenue: 28800, profit: 10800, ads: 2160, salary: 4000, accumulated: 36340 },
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Postar spoilers (Frasco, silhueta)',
                    'Criar Landing Page "Lista de Espera"',
                    'Desviar 50% da verba de Ads para capta√ß√£o de Leads',
                    'Abrir Grupo VIP de Lan√ßamento no WhatsApp'
                ]
            },
            {
                id: 10,
                month: 'Novembro',
                phase: 'Fase 6: O LAN√áAMENTO',
                focus: 'Black Friday & Marca Pr√≥pria',
                desc: 'O grande dia. Lan√ßamento do The Chairman. Meta de esgotar o estoque em 72 horas.',
                tip: 'A oferta √© Rei. "De R$ 389 por R$ 297 - Lote Fundador".',
                stats: { sales: 300, revenue: 99000, profit: 50000, ads: 8000, salary: 10000, accumulated: 80000 }, // Estimated blowout
                actual: { sales: 0, revenue: 0, profit: 0 },
                tasks: [
                    'Revela√ß√£o total do produto (Design/Notas)',
                    'Abertura Antecipada para Grupo VIP (Ter√ßa)',
                    'Abertura Geral (Black Friday)',
                    'Mutir√£o de envio e log√≠stica',
                    'Comemorar a vit√≥ria'
                ]
            }
        ];

        let currentMonthIndex = 0;
        let globalActualCash = 0;
        let monthlyChartInstance = null;
        let yearlyChartInstance = null;

        // --- DOM ELEMENTS ---
        const monthNav = document.getElementById('month-nav');
        const checklistContainer = document.getElementById('checklist-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const cashBar = document.getElementById('cash-bar');
        const taskProgressBar = document.getElementById('task-progress-bar');
        const taskProgressText = document.getElementById('task-progress-text');

        // --- INIT ---
        function init() {
            renderNav();
            loadMonth(0);
            renderYearlyChart();
            updateGlobalHeader();
        }

        // --- LOGIC: ADD SALE ---
        function addSale() {
            const input = document.getElementById('sale-input');
            const value = parseFloat(input.value);
            
            if (isNaN(value) || value <= 0) return;

            const currentData = appData[currentMonthIndex];
            
            // Update Monthly Actuals
            currentData.actual.sales += 1;
            currentData.actual.revenue += value;
            
            // Calculate Profit (Simplified: Revenue - Cost(100))
            const estimatedCost = 100;
            const marginalProfit = value - estimatedCost;
            currentData.actual.profit += marginalProfit;
            
            // Update Global Counter
            globalActualCash += marginalProfit;

            // Visual Updates
            updateDashboardNumbers();
            updateGlobalHeader();

            // Trigger Animation
            const els = ['stat-sales', 'stat-revenue', 'stat-profit-real'];
            els.forEach(id => {
                const el = document.getElementById(id);
                el.classList.remove('number-bump');
                void el.offsetWidth; // trigger reflow
                el.classList.add('number-bump');
            });
        }

        function updateDashboardNumbers() {
            const data = appData[currentMonthIndex];
            
            // Update Text
            document.getElementById('stat-sales').innerText = `${data.actual.sales} / ${data.stats.sales} un.`;
            document.getElementById('stat-revenue').innerText = `R$ ${data.actual.revenue.toLocaleString('pt-BR')} / R$ ${data.stats.revenue.toLocaleString('pt-BR')}`;
            document.getElementById('stat-profit-real').innerText = `R$ ${data.actual.profit.toLocaleString('pt-BR')}`;
            
            // Update Progress Bar (Revenue Based)
            const pct = Math.min(100, Math.round((data.actual.revenue / data.stats.revenue) * 100));
            document.getElementById('progress-bar').style.width = `${pct}%`;
            document.getElementById('progress-text').innerText = `${pct}%`;

            // Update color based on success
            if(pct >= 100) {
                document.getElementById('progress-bar').classList.remove('bg-emerald-500');
                document.getElementById('progress-bar').classList.add('bg-amber-500'); // Gold for success
            }
        }

        function updateGlobalHeader() {
            // Update Header
            const targetCash = 36340;
            const cashDisplay = document.getElementById('global-cash-display');
            cashDisplay.innerText = `R$ ${globalActualCash.toLocaleString('pt-BR')} / R$ ${targetCash.toLocaleString('pt-BR')}`;

            // Update Sidebar Cash Bar
            const cashDisplaySidebar = document.getElementById('stat-cash');
            cashDisplaySidebar.innerText = `R$ ${globalActualCash.toLocaleString('pt-BR')}`;
            
            const cashPct = Math.min(100, (globalActualCash / targetCash) * 100);
            document.getElementById('cash-bar').style.width = `${cashPct}%`;
        }

        // --- NEW: TASK PROGRESS LOGIC ---
        function updateTaskProgress() {
             const inputs = checklistContainer.querySelectorAll('input[type="checkbox"]');
             const checked = checklistContainer.querySelectorAll('input[type="checkbox"]:checked');
             const count = checked.length;
             const total = inputs.length;
             const pct = total > 0 ? (count / total) * 100 : 0;
             
             taskProgressBar.style.width = `${pct}%`;
             taskProgressText.innerText = `${count}/${total} Conclu√≠das`;

             if(pct >= 100) {
                 taskProgressBar.classList.remove('bg-slate-600');
                 taskProgressBar.classList.add('bg-amber-500');
             } else {
                 taskProgressBar.classList.add('bg-slate-600');
                 taskProgressBar.classList.remove('bg-amber-500');
             }
        }


        // --- RENDERING ---
        function renderNav() {
            monthNav.innerHTML = '';
            appData.forEach((data, index) => {
                const btn = document.createElement('button');
                btn.className = `nav-item w-full text-left p-4 border-b border-gray-100 hover:bg-slate-50 transition-colors ${index === 0 ? 'active' : ''}`;
                btn.onclick = () => loadMonth(index);
                btn.innerHTML = `
                    <div class="flex justify-between items-center">
                        <span class="font-bold text-sm uppercase tracking-wide">${data.month.substring(0, 3)}</span>
                        ${index === 10 ? '<span class="text-[10px] bg-amber-100 text-amber-800 px-1 rounded">‚òÖ</span>' : ''}
                    </div>
                    <div class="text-[10px] text-slate-400 truncate mt-1">${data.focus}</div>
                `;
                monthNav.appendChild(btn);
            });
        }

        function loadMonth(index) {
            currentMonthIndex = index;
            const data = appData[index];

            // Update UI Styling for Active Nav
            document.querySelectorAll('.nav-item').forEach((el, i) => {
                el.classList.toggle('active', i === index);
                if(i === index) {
                    el.classList.add('bg-slate-800', 'text-white', 'border-l-4', 'border-amber-600');
                    el.classList.remove('hover:bg-slate-50');
                } else {
                    el.classList.remove('bg-slate-800', 'text-white', 'border-l-4', 'border-amber-600');
                    el.classList.add('hover:bg-slate-50');
                }
            });

            // Content Updates
            document.getElementById('current-phase-badge').innerText = data.phase;
            document.getElementById('month-title').innerText = `${data.month}: ${data.focus}`;
            document.getElementById('month-desc').innerText = data.desc;
            document.getElementById('month-tip').innerText = data.tip;

            // Stats (Target)
            document.getElementById('stat-ads').innerText = `R$ ${data.stats.ads.toLocaleString('pt-BR')}`;
            
            // Trigger Dashboard Update to show Actuals vs Targets
            updateDashboardNumbers();

            // Checklist
            renderChecklist(data.tasks);

            // Monthly Chart
            renderMonthlyChart(data.stats);
        }

        function renderChecklist(tasks) {
            checklistContainer.innerHTML = '';
            tasks.forEach((task, i) => {
                const id = `task-${currentMonthIndex}-${i}`;
                const div = document.createElement('div');
                div.className = 'checkbox-wrapper relative';
                div.innerHTML = `
                    <input type="checkbox" id="${id}" class="peer absolute w-full h-full opacity-0 cursor-pointer" onchange="updateTaskProgress()">
                    <div class="flex items-start gap-3 p-4 bg-white border border-gray-200 rounded-md transition-all duration-200 peer-hover:border-amber-300">
                        <div class="w-5 h-5 flex-none rounded border border-gray-300 flex items-center justify-center bg-white transition-colors peer-checked:bg-slate-600 peer-checked:border-slate-600 check-box-square">
                             <svg class="check-icon w-3 h-3 text-white opacity-0 transition-opacity" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <label for="${id}" class="text-sm font-medium text-slate-700 select-none cursor-pointer flex-1">${task}</label>
                    </div>
                `;
                checklistContainer.appendChild(div);
            });
            updateTaskProgress(); // Init bar for current month
        }

        function resetChecklist() {
             checklistContainer.querySelectorAll('input[type="checkbox"]').forEach(input => input.checked = false);
             updateTaskProgress();
        }

        // --- CHARTS ---
        function renderMonthlyChart(stats) {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            const productCost = stats.sales * 100;
            const netCashToVault = stats.profit - stats.ads - stats.salary; 
            const displayVault = Math.max(0, netCashToVault);

            if (monthlyChartInstance) monthlyChartInstance.destroy();

            monthlyChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Custo Produto', 'Reinvest. Tr√°fego', 'Seu Pro-Labore', 'Caixa Empresa'],
                    datasets: [{
                        data: [productCost, stats.ads, stats.salary, displayVault],
                        backgroundColor: ['#CBD5E1', '#F59E0B', '#94A3B8', '#059669'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '75%',
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed !== null) label += new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(context.parsed);
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderYearlyChart() {
            const ctx = document.getElementById('yearlyChart').getContext('2d');
            
            const labels = appData.map(d => d.month.substring(0, 3));
            const revenueData = appData.map(d => d.stats.revenue);
            const cashData = appData.map(d => d.stats.accumulated);
            const adsData = appData.map(d => d.stats.ads);

            if (yearlyChartInstance) yearlyChartInstance.destroy();

            yearlyChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Caixa Acumulado',
                            data: cashData,
                            type: 'line',
                            borderColor: '#059669',
                            backgroundColor: '#059669',
                            borderWidth: 3,
                            pointRadius: 4,
                            pointBackgroundColor: '#fff',
                            pointBorderWidth: 2,
                            yAxisID: 'y',
                            tension: 0.4
                        },
                        {
                            label: 'Invest. Tr√°fego',
                            data: adsData,
                            type: 'line',
                            borderColor: '#F59E0B',
                            borderDash: [5, 5],
                            borderWidth: 2,
                            pointRadius: 0,
                            yAxisID: 'y',
                            tension: 0.4
                        },
                        {
                            label: 'Faturamento Mensal',
                            data: revenueData,
                            backgroundColor: '#E2E8F0',
                            borderRadius: 4,
                            yAxisID: 'y'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: { position: 'top', align: 'end', labels: { usePointStyle: true, boxWidth: 8 } }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { display: true, borderDash: [2, 4], color: '#f1f1f1' },
                            ticks: { callback: (value) => 'R$ ' + value/1000 + 'k' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        // Start App
        init();

    </script>
</body>
</html>
